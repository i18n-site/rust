CREATE FUNCTION "hostId"(val VARBINARY(255)) RETURNS BIGINT UNSIGNED
BEGIN
 DECLARE id BIGINT UNSIGNED;
 SELECT host.id INTO id FROM host WHERE v=val;
 IF id IS NULL THEN
   INSERT INTO host (v) VALUES (val);
   SET id = LAST_INSERT_ID();
 END IF;
 RETURN id;
END ;;